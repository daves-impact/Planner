# ğŸ—ï¸ APPLICATION ARCHITECTURE

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      USER INTERFACE LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Login      â”‚  â”‚ Register     â”‚  â”‚   Home       â”‚             â”‚
â”‚  â”‚   Screen     â”‚  â”‚   Screen     â”‚  â”‚   Screen     â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Add Task    â”‚  â”‚   Planner    â”‚  â”‚   Profile    â”‚             â”‚
â”‚  â”‚   Screen     â”‚  â”‚   Screen     â”‚  â”‚   Screen     â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â–²
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Navigation Router   â”‚
                    â”‚   (Expo Router)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STATE MANAGEMENT LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚              Auth Context (AuthContext.tsx)                    â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Session state                                          â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ User info                                              â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Auth methods (sign in, sign up, sign out)            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Loading states                                        â”‚ â”‚ â”‚
â”‚  â”‚  â”‚ â€¢ Error handling                                        â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SERVICES LAYER                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Task Service          â”‚    â”‚   AI Service                    â”‚ â”‚
â”‚  â”‚ (taskService.ts)        â”‚    â”‚ (aiService.ts)                 â”‚ â”‚
â”‚  â”‚                         â”‚    â”‚                                 â”‚ â”‚
â”‚  â”‚ â€¢ getTasks()            â”‚    â”‚ â€¢ parseTaskText()              â”‚ â”‚
â”‚  â”‚ â€¢ addTask()             â”‚    â”‚   - Input: Natural language    â”‚ â”‚
â”‚  â”‚ â€¢ updateTask()          â”‚    â”‚   - Output: Structured task    â”‚ â”‚
â”‚  â”‚ â€¢ deleteTask()          â”‚    â”‚   - Fallback: Default values   â”‚ â”‚
â”‚  â”‚ â€¢ getStudyPlan()        â”‚    â”‚                                 â”‚ â”‚
â”‚  â”‚ â€¢ saveStudyPlan()       â”‚    â”‚ â€¢ generateStudyPlan()          â”‚ â”‚
â”‚  â”‚                         â”‚    â”‚   - Input: Task list           â”‚ â”‚
â”‚  â”‚ All Supabase calls      â”‚    â”‚   - Output: Schedule JSON      â”‚ â”‚
â”‚  â”‚ No UI logic here        â”‚    â”‚   - Fallback: Basic schedule   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   - Gemini API calls only      â”‚ â”‚
â”‚                                 â”‚   - Error handling included    â”‚ â”‚
â”‚                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚                              â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   Supabase Client         â”‚    â”‚   Google Gemini API           â”‚
     â”‚   (supabase/client.ts)    â”‚    â”‚                               â”‚
     â”‚                           â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚ â€¢ Initialization          â”‚    â”‚ â”‚ REST API Endpoint       â”‚  â”‚
     â”‚ â€¢ Auth methods            â”‚    â”‚ â”‚ https://generative...   â”‚  â”‚
     â”‚ â€¢ Query methods           â”‚    â”‚ â”‚ /v1beta/models/         â”‚  â”‚
     â”‚ â€¢ Real-time subscriptions â”‚    â”‚ â”‚ gemini-2.0-flash:       â”‚  â”‚
     â”‚                           â”‚    â”‚ â”‚ generateContent         â”‚  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                   â”‚                    â”‚                               â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚  Supabase Cloud Platform       â”‚                â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ PostgreSQL Database        â”‚â”‚    â”‚  Gemini API Server  â”‚
     â”‚  â”‚                            â”‚â”‚    â”‚                     â”‚
     â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚    â”‚ AI Models:          â”‚
     â”‚  â”‚ â”‚ tasks table          â”‚  â”‚â”‚    â”‚ â€¢ gemini-2.0-flash  â”‚
     â”‚  â”‚ â”‚ - id (UUID)          â”‚  â”‚â”‚    â”‚ â€¢ Various endpoints â”‚
     â”‚  â”‚ â”‚ - user_id (FK)       â”‚  â”‚â”‚    â”‚                     â”‚
     â”‚  â”‚ â”‚ - title              â”‚  â”‚â”‚    â”‚ Features:           â”‚
     â”‚  â”‚ â”‚ - description        â”‚  â”‚â”‚    â”‚ â€¢ Task parsing      â”‚
     â”‚  â”‚ â”‚ - duration (int)     â”‚  â”‚â”‚    â”‚ â€¢ Schedule gen      â”‚
     â”‚  â”‚ â”‚ - deadline           â”‚  â”‚â”‚    â”‚ â€¢ JSON output       â”‚
     â”‚  â”‚ â”‚ - priority           â”‚  â”‚â”‚    â”‚                     â”‚
     â”‚  â”‚ â”‚ - status             â”‚  â”‚â”‚    â”‚ Limits (Free):      â”‚
     â”‚  â”‚ â”‚ - created_at         â”‚  â”‚â”‚    â”‚ â€¢ 60 req/min        â”‚
     â”‚  â”‚ â”‚ - updated_at         â”‚  â”‚â”‚    â”‚ â€¢ 32K tokens/req    â”‚
     â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚  â”‚                            â”‚â”‚
     â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
     â”‚  â”‚ â”‚ study_plans table    â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - id (UUID)          â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - user_id (FK)       â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - date               â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - plan (JSONB)       â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - created_at         â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - updated_at         â”‚  â”‚â”‚
     â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
     â”‚  â”‚                            â”‚â”‚
     â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
     â”‚  â”‚ â”‚ RLS Policies         â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - SELECT             â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - INSERT             â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - UPDATE             â”‚  â”‚â”‚
     â”‚  â”‚ â”‚ - DELETE             â”‚  â”‚â”‚
     â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚  â€¢ Authentication              â”‚
     â”‚  â€¢ Authorization              â”‚
     â”‚  â€¢ Real-time Sync             â”‚
     â”‚  â€¢ Data Persistence           â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER INTERACTION                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Sign Up/Login  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  AuthContext.signUp/In()   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  supabase.auth.signUp/In()        â”‚
    â”‚  (Supabase Auth)                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Session Created           â”‚
    â”‚  User Authenticated        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚                          â”‚                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚  Create Task    â”‚    â”‚  Create Task w/AI â”‚    â”‚  Generate Plan     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                      â”‚                          â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Manual Input:   â”‚    â”‚ AI Input:         â”‚    â”‚ getTasks()         â”‚
    â”‚ - Title         â”‚    â”‚ - Natural lang    â”‚    â”‚ (from Supabase)    â”‚
    â”‚ - Duration      â”‚    â”‚                   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ - Deadline      â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚ - Priority      â”‚             â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚generateStudyPlan()  â”‚
             â”‚             â”‚parseTaskText()     â”‚  â”‚ (aiService.ts)      â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ (aiService.ts)     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ addTask()       â”‚    â”‚                    â”‚             â”‚
    â”‚ (taskService)   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
    â”‚                 â”‚             â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚Gemini API Call    â”‚
             â”‚             â”‚Gemini API Call     â”‚  â”‚ (Gem 2.0 Flash)   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚ prompt:            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚supabase.from()  â”‚    â”‚ "Parse this text"  â”‚            â”‚
    â”‚.insert()        â”‚    â”‚                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ (tasks table)   â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚JSON Response:     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚             â”‚ { schedule: [...] â”‚
             â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚JSON Response:      â”‚            â”‚
    â”‚Task Saved       â”‚   â”‚ {                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚Display Success  â”‚   â”‚   title: "...",    â”‚  â”‚saveStudyPlan()     â”‚
    â”‚                 â”‚   â”‚   duration: X,     â”‚  â”‚ (taskService.ts)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   deadline: "...", â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚   priority: "..."  â”‚            â”‚
                          â”‚ }                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚supabase.from()     â”‚
                                   â”‚             â”‚.insert/update()    â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚(study_plans table) â”‚
                          â”‚addTask()           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚(taskService.ts)    â”‚            â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚             â”‚Plan Saved          â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚Display in Screen   â”‚
                          â”‚supabase.from()     â”‚  â”‚                    â”‚
                          â”‚.insert()           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚(tasks table)       â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚Task Saved          â”‚
                          â”‚Display Success     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Dependency Tree

```
App (_layout.tsx)
â”‚
â”œâ”€â”€ AuthProvider (AuthContext.tsx)
â”‚   â”‚
â”‚   â””â”€â”€ RootLayoutNav
â”‚       â”‚
â”‚       â”œâ”€â”€ Auth Stack (Not Authenticated)
â”‚       â”‚   â”œâ”€â”€ LoginScreen.tsx
â”‚       â”‚   â””â”€â”€ RegisterScreen.tsx
â”‚       â”‚
â”‚       â””â”€â”€ App Stack (Authenticated)
â”‚           â”‚
â”‚           â”œâ”€â”€ TabsLayout (_layout.tsx)
â”‚           â”‚   â”œâ”€â”€ HomeScreen
â”‚           â”‚   â”‚   â”œâ”€â”€ FlatList
â”‚           â”‚   â”‚   â”œâ”€â”€ TaskCard (each)
â”‚           â”‚   â”‚   â””â”€â”€ Services
â”‚           â”‚   â”‚       â””â”€â”€ taskService.getTasks()
â”‚           â”‚   â”‚
â”‚           â”‚   â”œâ”€â”€ AddTaskScreen
â”‚           â”‚   â”‚   â”œâ”€â”€ Manual Input Section
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ TextInput (title)
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ TextInput (description)
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ PrioritySelector
â”‚           â”‚   â”‚   â”‚   â””â”€â”€ DurationSelector
â”‚           â”‚   â”‚   â”‚
â”‚           â”‚   â”‚   â”œâ”€â”€ AI Input Section
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ TextInput (natural lang)
â”‚           â”‚   â”‚   â”‚   â””â”€â”€ ParseButton
â”‚           â”‚   â”‚   â”‚       â””â”€â”€ aiService.parseTaskText()
â”‚           â”‚   â”‚   â”‚
â”‚           â”‚   â”‚   â””â”€â”€ Services
â”‚           â”‚   â”‚       â””â”€â”€ taskService.addTask()
â”‚           â”‚   â”‚
â”‚           â”‚   â”œâ”€â”€ PlannerScreen
â”‚           â”‚   â”‚   â”œâ”€â”€ ScheduleList
â”‚           â”‚   â”‚   â”‚   â”œâ”€â”€ ScheduleItem (each)
â”‚           â”‚   â”‚   â”‚   â””â”€â”€ BreakItem (each)
â”‚           â”‚   â”‚   â”‚
â”‚           â”‚   â”‚   â”œâ”€â”€ GenerateButton
â”‚           â”‚   â”‚   â”‚   â””â”€â”€ aiService.generateStudyPlan()
â”‚           â”‚   â”‚   â”‚
â”‚           â”‚   â”‚   â””â”€â”€ Services
â”‚           â”‚   â”‚       â”œâ”€â”€ taskService.getTasks()
â”‚           â”‚   â”‚       â””â”€â”€ taskService.saveStudyPlan()
â”‚           â”‚   â”‚
â”‚           â”‚   â””â”€â”€ ProfileScreen
â”‚           â”‚       â”œâ”€â”€ UserInfo
â”‚           â”‚       â”œâ”€â”€ Features List
â”‚           â”‚       â””â”€â”€ LogoutButton
â”‚           â”‚           â””â”€â”€ AuthContext.signOut()
â”‚           â”‚
â”‚           â””â”€â”€ Modal (add-task.tsx)
â”‚               â””â”€â”€ AddTaskScreen
â”‚
â””â”€â”€ Utilities & Hooks
    â”œâ”€â”€ dateUtils.ts
    â”œâ”€â”€ useColorScheme.ts
    â””â”€â”€ useAuth() (from AuthContext)
```

## API Call Flow

### Task Parsing Flow

```
User Input: "Study Math for 2 hours tomorrow evening"
    â†“
AddTaskScreen.tsx
    â†“
aiService.parseTaskText(text)
    â†“
Prompt Construction:
  "Parse this task description and return ONLY valid JSON..."
    â†“
Fetch to Gemini API
  POST /v1beta/models/gemini-2.0-flash:generateContent?key=KEY
  Body: { contents: [{ parts: [{ text: prompt }] }] }
    â†“
Gemini API Response:
  {
    "candidates": [{
      "content": {
        "parts": [{
          "text": "{\"title\": \"Math\", \"duration\": 120, ...}"
        }]
      }
    }]
  }
    â†“
Parse JSON from response
    â†“
Return ParsedTask object:
  {
    title: "Math",
    duration: 120,
    deadline: "2025-01-15T18:00:00",
    priority: "medium"
  }
    â†“
Fallback (if error):
  {
    title: "Study Math for 2 hours tomorrow evening",
    duration: 60,
    deadline: [tomorrow at 6 PM],
    priority: "medium"
  }
    â†“
Display in AddTaskScreen
User clicks Save
    â†“
taskService.addTask()
```

### Study Plan Generation Flow

```
User clicks "Generate AI Plan"
    â†“
PlannerScreen.tsx
    â†“
getTasks() â†’ Fetch all user tasks from Supabase
    â†“
aiService.generateStudyPlan(tasks)
    â†“
Prompt Construction:
  "Create an optimized study schedule for today..."
  Include task list
    â†“
Fetch to Gemini API
  (Similar to task parsing)
    â†“
Gemini API Response:
  {
    "candidates": [{
      "content": {
        "parts": [{
          "text": "{\"date\": \"2025-01-15\", \"schedule\": [...]}"
        }]
      }
    }]
  }
    â†“
Parse JSON from response
    â†“
Return StudyPlan object:
  {
    date: "2025-01-15",
    schedule: [
      { start: "08:00", end: "10:00", task: "Math" },
      { start: "10:00", end: "10:15", break: true },
      ...
    ]
  }
    â†“
Fallback (if error):
  Basic schedule with default time slots
    â†“
Save to Supabase (study_plans table)
    â†“
Display in PlannerScreen
```

## State Management Flow

```
App Root
  â”‚
  â””â”€â”€ AuthProvider
      â”‚
      â”œâ”€â”€ Session State
      â”‚   â”œâ”€â”€ session (Session | null)
      â”‚   â”œâ”€â”€ user (User | null)
      â”‚   â””â”€â”€ isLoading (boolean)
      â”‚
      â”œâ”€â”€ Methods
      â”‚   â”œâ”€â”€ signUp(email, password)
      â”‚   â”œâ”€â”€ signIn(email, password)
      â”‚   â””â”€â”€ signOut()
      â”‚
      â””â”€â”€ useAuth() Hook
          â”‚
          â”œâ”€â”€ LoginScreen
          â”‚   â”œâ”€â”€ uses signUp()
          â”‚   â”œâ”€â”€ uses signIn()
          â”‚   â””â”€â”€ reads isLoading
          â”‚
          â”œâ”€â”€ RegisterScreen
          â”‚   â””â”€â”€ uses signUp()
          â”‚
          â”œâ”€â”€ HomeScreen
          â”‚   â”œâ”€â”€ uses useAuth() for user
          â”‚   â””â”€â”€ renders tasks from taskService
          â”‚
          â”œâ”€â”€ AddTaskScreen
          â”‚   â”œâ”€â”€ uses useAuth() for user
          â”‚   â”œâ”€â”€ calls taskService.addTask()
          â”‚   â””â”€â”€ calls aiService.parseTaskText()
          â”‚
          â”œâ”€â”€ PlannerScreen
          â”‚   â”œâ”€â”€ uses useAuth() for user
          â”‚   â”œâ”€â”€ calls taskService.getTasks()
          â”‚   â”œâ”€â”€ calls aiService.generateStudyPlan()
          â”‚   â””â”€â”€ calls taskService.saveStudyPlan()
          â”‚
          â””â”€â”€ ProfileScreen
              â””â”€â”€ uses signOut()
```

## Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ auth.users          â”‚
â”‚ (Supabase Auth)     â”‚
â”‚                     â”‚
â”‚ - id (UUID) â—„â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”
â”‚ - email             â”‚  â”‚
â”‚ - encrypted_pw      â”‚  â”‚
â”‚                     â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                         â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ user_id FK
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tasks                â”‚ â”‚ â”‚ study_plans          â”‚
â”‚                      â”‚ â”‚ â”‚                      â”‚
â”‚ - id (UUID)          â”‚ â”‚ â”‚ - id (UUID)          â”‚
â”‚ - user_id (FK) â—„â”€â”€â”€â”€â”€â”¼â”€â”¤ - user_id (FK) â—„â”€â”€â”€â”€â”€â”¤
â”‚ - title              â”‚ â”‚ â”‚ - date               â”‚
â”‚ - description        â”‚ â”‚ â”‚ - plan (JSONB)       â”‚
â”‚ - duration (int)     â”‚ â”‚ â”‚ - created_at         â”‚
â”‚ - deadline           â”‚ â”‚ â”‚ - updated_at         â”‚
â”‚ - priority           â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ - status             â”‚ â”‚
â”‚ - created_at         â”‚ â”‚
â”‚ - updated_at         â”‚ â”‚
â”‚                      â”‚ â”‚
â”‚ Indexes:             â”‚ â”‚
â”‚ - user_id            â”‚ â”‚
â”‚ - deadline           â”‚ â”‚
â”‚ - created_at         â”‚ â”‚
â”‚                      â”‚ â”‚
â”‚ RLS Policies:        â”‚ â”‚
â”‚ - SELECT: own only   â”‚ â”‚
â”‚ - INSERT: own only   â”‚ â”‚
â”‚ - UPDATE: own only   â”‚ â”‚
â”‚ - DELETE: own only   â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                         â”‚
                         â”‚
            RLS Policies: â”‚
            - SELECT      â”‚
            - INSERT      â”‚
            - UPDATE      â”‚
            - DELETE      â”‚
```

## Error Handling Flow

```
User Action
    â†“
Service Call (taskService or aiService)
    â†“
Try-Catch Block
    â”‚
    â”œâ”€ Success
    â”‚   â””â”€ Return Data
    â”‚       â†“
    â”‚   Update UI
    â”‚       â†“
    â”‚   Show Success Message (if needed)
    â”‚
    â””â”€ Error
        â”œâ”€ Supabase Error
        â”‚   â”œâ”€ RLS Policy Violation
        â”‚   â”‚   â””â”€ Alert: "You don't have permission"
        â”‚   â”‚
        â”‚   â””â”€ Network Error
        â”‚       â””â”€ Alert: "Connection failed"
        â”‚
        â”œâ”€ Gemini API Error
        â”‚   â”œâ”€ 401 Unauthorized
        â”‚   â”‚   â””â”€ Use Fallback Logic
        â”‚   â”‚
        â”‚   â”œâ”€ 429 Rate Limited
        â”‚   â”‚   â””â”€ Alert: "Rate limit. Retry later"
        â”‚   â”‚
        â”‚   â””â”€ Network Error
        â”‚       â””â”€ Use Fallback Logic
        â”‚
        â””â”€ Unknown Error
            â””â”€ Alert: "Something went wrong"
```

This architecture ensures:

- âœ“ Separation of concerns
- âœ“ Testability
- âœ“ Scalability
- âœ“ Error handling
- âœ“ Security
- âœ“ Performance
